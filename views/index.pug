extends base
block content
  .container.pt-4
    h1 Bienvenido a VuelaMAS
    .row.mt-5
      .col-12
        - if (!ofertasVuelos && !escalasOfertadas && !pasajeR && !asientos && !nuevoVuelo)
          h4.mt-5 Busca ofertas de vuelos
            div.card.bg-dark
              div.card-body.text-white
                form(action='buscarOfertas/' method="POST")
                  .form-group
                    label(for='Origen') Origen
                    select#Origen.select.form-control.input-lg(type='text' name='Origen')
                      - for (var i = 0; i < aeropuertos.length; i++)
                        option(value=`${aeropuertos[i].CodigoIATA}`) #{aeropuertos[i].Ciudad} (#{aeropuertos[i].CodigoIATA})
                  .form-group
                    label(for='Destino') Destino
                    select#Destino.select.form-control.input-lg(type='text' name='Destino')
                      - for (var i = 0; i < aeropuertos.length; i++)
                        option(value=`${aeropuertos[i].CodigoIATA}`) #{aeropuertos[i].Ciudad} (#{aeropuertos[i].CodigoIATA})
                  .form-group
                    label(for='FechaSalida') Fecha de Viaje
                    input#FechaSalida.form-control(type='date' name='FechaSalida')
                  .form-group
                    button.btn.btn-primary(type='submit') Buscar
        - if (ofertasVuelos)
          h2 Ofertas
          .row.mt-5
            .col-12
              table.table.bg-white
                thead
                  tr
                    th(scope='col') ID    
                    th(scope='col') Ruta
                    th(scope='col') Fecha
                    th(scope='col') Avión
                    th(scope='col') Hora de Salida (Local Origen)
                    th(scope='col') Hora de Llegada (Local Destino)
                    th(scope='col') Estado
                tbody
                  - for (var i = 0; i < ofertasVuelos.length; i++)
                    tr
                      th(scope='row') #{ofertasVuelos[i].ID}
                      td #{ofertasVuelos[i].CodigoIATAOrigen}-#{ofertasVuelos[i].CodigoIATADestino}
                      td #{ofertasVuelos[i].FechaSalida}
                      td #{ofertasVuelos[i].IDAvion}
                      td #{ofertasVuelos[i].HoraSalida}
                      td #{ofertasVuelos[i].HoraLlegada}
                      td #{ofertasVuelos[i].Estado}
        - if (escalasOfertadas)
          h3.text-center Ofertas
          .row.mt-5
            - for (let i =0; i< escalasOfertadas.length; i++)
              .col-6
                table.table.btn-outline-dark
                  thead.card-header
                    tr.bg-none
                      - if ((escalasOfertadas[i].length - 1) > 1)
                        th(scope='col') #{escalasOfertadas[i].length - 1} Escalas
                      - else
                        th(scope='col') #{escalasOfertadas[i].length - 1} Escala
                      th(scope='col') Viaje
                      th(scope='col')
                  tbody.card-body
                    tr
                      td
                        - for (let j = 1; j < escalasOfertadas[i].length; j++)
                          p #{escalasOfertadas[i][j].CodigoIATAOrigen}
                      td #{escalasOfertadas[i][0].CodigoIATAOrigen} - #{escalasOfertadas[i][(escalasOfertadas[i].length - 1)].Destino}
                      td
                        form(action=`#`, method="POST")
                          button.btn.btn-outline-warning(type='submit') Ver oferta
        - if(pasajesCheckIn)
          h4.mt-5 Realizar Check-In
            div.card.bg-dark
                div.card-body.text-white
                  form(action='checkin/' method="POST")
                    .form-group
                      label(for='Pasaje') ID Pasaje
                      select#Pasaje.select.form-control.input-lg(type='number' name='Pasaje')
                        - for (var i = 0; i < pasajesCheckIn.length; i++)
                          option(value=`${pasajesCheckIn[i].ID}`) #{pasajesCheckIn[i].ID} - #{pasajesCheckIn[i].ApellidoP}, #{pasajesCheckIn[i].NombreP}
                    .form-group
                      button.btn.btn-primary(type='submit') Proceder
        - if (pasajeR && vueloR)
          h4.mt-5 Datos del Pasaje
            table.table.bg-white
              thead
                tr
                  th(scope='col') ID Pasaje
                  th(scope='col') Pasajero
                  th(scope='col') ID Vuelo
                  th(scope='col') Origen
                  th(scope='col') Destino
                  th(scope='col') Fecha
                  th(scope='col') Hora de Salida
              tbody
                tr
                  th(scope='row') #{pasajeR[0].ID}
                  td #{pasajeR[0].ApellidoP}, #{pasajeR[0].NombreP} 
                  td #{vueloR[0].ID}
                  td #{vueloR[0].Origen}
                  td #{vueloR[0].Destino}
                  td #{vueloR[0].Fecha}
                  td #{vueloR[0].Hora}
                tr
                  td
                    form(action=`confirm/${pasajeR[0].ID}/${vueloR[0].ID}/`, method="GET")
                      button.btn.btn-outline-danger(type='submit') Confirmar Check-In
                  td
                    form(action=`select-flight/${pasajeR[0].ID}/${vueloR[0].ID}/`, method="GET")
                      button.btn.btn-outline-danger(type='submit') Abordar Vuelo Distinto
        - if (asientos && asientosE && asientosPC && cliente)
          h4.mt-5 Seleccione su asiento
            div.card.bg-dark
                div.card-body.text-white
                  form(action='get-seat/' method="POST")
                    .form-group
                      label(for='Asiento') Número de Asiento
                      select#Asiento.select.form-control.input-lg(type='number' name='Asiento')
                        - if (cliente[0].Clase == "Economica")
                          - for (var i = 0; i < asientos[0].AsientosE; i++)
                            - if (`${asientosE[i][1]}` == "Libre")
                                  option(value=`${asientosE[i][0]}`) Económica - No. #{asientosE[i][0]}
                        - if (cliente[0].Clase == "Primera Clase")
                          - for (var i = 0; i < asientos[0].AsientosPC; i++)
                            - if ((asientosPC[i][1]) == "Libre")
                              option(value=`${asientosPC[i][0]}`) Primera Clase - No. #{asientosPC[i][0]}
                    .form-group
                      button.btn.btn-primary(type='submit') Seleccionar
        - if (nuevoVuelo && pasajeND)
          h4.mt-5 Seleccione un vuelo nuevo
          h4.mt-5 Ruta #{nuevoVuelo[0].Origen} - #{nuevoVuelo[0].Destino}
            table.table.bg-white
              thead
                tr
                  th(scope='col') ID Vuelo
                  th(scope='col') Fecha de Salida
                  th(scope='col') Hora de Llegada
              tbody
                - for (var i = 0; i < nuevoVuelo.length; i++)
                  tr
                    th(scope='row') #{nuevoVuelo[i].ID}
                    td #{nuevoVuelo[i].Fecha}
                    td #{nuevoVuelo[i].Hora}
                    td
                      form(action=`/checkin/confirm/${pasajeND}/${nuevoVuelo[i].ID}/`, method="GET")
                        button.btn.btn-outline-danger(type='submit') Seleccionar Vuelo